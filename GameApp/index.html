<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <script src="js/mui.min.js"></script>
	<script src="js/mui.enterfocus.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="css/ui.css" />
</head>
<body> 
	<nav class="mui-bar mui-bar-tab my-bar-tab" id="bottom-navigation">
	    <a class="mui-tab-item mui-active" tabindex="0">
	        <span class="mui-icon mui-icon-home"></span>
	        <span class="mui-tab-label">首页</span>
	    </a>
	    <a class="mui-tab-item" tabindex="1">
	        <span class="mui-icon mui-icon-phone"></span>
	        <span class="mui-tab-label">游戏大厅</span>
	    </a>
	    <a class="mui-tab-item" tabindex="2">
	        <span class="mui-icon mui-icon-email"></span>
	        <span class="mui-tab-label">聊天群组</span>
	    </a>
	    <a class="mui-tab-item" tabindex="3">
	        <span class="mui-icon mui-icon-gear"></span>
	        <span class="mui-tab-label">个人中心</span>
	    </a>
	</nav>
	
	<script src="js/config.js"></script>
	<script src="js/app.js"></script> 
	
	<script type="text/javascript">
		
		var pages = [{
			id: "home",
			url: "html/home.html",
			style: {
				top: "0px",
				bottom: "50px",
				titleNView: {                       // 窗口的标题栏控件
			      titleText:"首页",                // 标题栏文字,当不设置此属性时，默认加载当前页面的标题，并自动更新页面的标题
			      titleColor:"#fff",             // 字体颜色,颜色值格式为"#RRGGBB",默认值为"#000000"
			      titleSize:"17px",                 // 字体大小,默认17px
			      backgroundColor:"#FE532A",        // 控件背景颜色,颜色值格式为"#RRGGBB",默认值为"#F7F7F7"
		      	  // type:'transparent',//透明渐变样式
			    }
			}
		},{
			id: "sala",
			url: "html/sala.html",
			style: {
				top: "0px",
				bottom: "50px",
				titleNView: {                       // 窗口的标题栏控件
			      titleText:"游戏大厅",                // 标题栏文字,当不设置此属性时，默认加载当前页面的标题，并自动更新页面的标题
			      titleColor:"#fff",             // 字体颜色,颜色值格式为"#RRGGBB",默认值为"#000000"
			      titleSize:"17px",                 // 字体大小,默认17px
			      backgroundColor:"#FE532A",        // 控件背景颜色,颜色值格式为"#RRGGBB",默认值为"#F7F7F7"

			    }
			}
		},{
			id: "room",
			url: "html/room.html",
			style: {
				top: "0px",
				bottom: "50px",
				titleNView: {                       // 窗口的标题栏控件
			      titleText:"游戏房间",                // 标题栏文字,当不设置此属性时，默认加载当前页面的标题，并自动更新页面的标题
			      titleColor:"#fff",             // 字体颜色,颜色值格式为"#RRGGBB",默认值为"#000000"
			      titleSize:"17px",                 // 字体大小,默认17px
			      backgroundColor:"#FE532A",        // 控件背景颜色,颜色值格式为"#RRGGBB",默认值为"#F7F7F7"

			    }
			}
		},{
			id: "my",
			url: "html/my.html",
			style: {
				top: "0px",
				bottom: "50px"
			}
		}];
		
		   
		(function($, doc) {
			$.init({
				statusBarStyle: "light",
				statusBarBackground: '#fe5a2f'
			});
			
			
			$.plusReady(function() {
				// 设置顶部状态栏样式
				plus.navigator.setStatusBarStyle("light");
				plus.navigator.setStatusBarBackground("#FE532A");
				
				// 禁止屏幕翻转
				plus.screen.lockOrientation("portrait-primary");
				 
				
				// 系统回退键监听
				$.oldBack = mui.back;
				var backButtonPress = 0;
				$.back = function(event) {
					backButtonPress++;
					if (backButtonPress > 1) {
						plus.runtime.quit();
					} else {
						plus.nativeUI.toast('再按一次退出应用');
					}
					setTimeout(function() {
						backButtonPress = 0;
					}, 1000);
					return false;
				};
				 
				 
				// 初始化webView列表
				var currentWebView = plus.webview.currentWebview();
				// 动态创建webView对象
				for (var i = 0; i < pages.length; i++) {
					var page = plus.webview.create(pages[i].url
						,pages[i].id
						,pages[i].style);
					page.hide();
					currentWebView.append(page);
				}
				plus.webview.show(pages[0].id);
				
				// 注册TAB触摸事件
				mui(".mui-bar-tab").on("tap", "a", function(){
					var tabindex = this.getAttribute("tabindex");
					plus.webview.show(pages[tabindex].id, "fade-in", 200);
					for (var i = 0 ; i < pages.length ; i ++) {
						if (i != tabindex) { 
							plus.webview.hide(pages[i].id, "fade-out", 200);
						}
					}
				})
				
				 
			});
		}(mui, document));
		
		 
		
		/**
		 * 初始化所有的webView 韦德 2018年8月12日18:05:38
		 */
		function initWebViewList(){
			var defaultStyle = {
				top: "44px",
				bottom: "50px"
			}
			var currentWebView = plus.webview.currentWebview();
			// 动态创建webView对象
			for (var i = 0; i < pages.length; i++) {
				var page = plus.webview.create(pages[i].url
					,pages[i].id
					,defaultStyle)
				page.hide();
				currentWebView.append(page);
			}
			plus.webview.show(pages[0].id);
		}
		
		/**
		 * 显示指定的webView 韦德 2018年8月12日18:05:12
		 * @param {Object} tabindex
		 */
		function showWebView(tabindex){
			plus.webview.show(pages[tabindex].id, "fade-in", 200);
			hideOtherWebView(tabindex);
		}
		
		/**
		 * 隐藏非焦点webView 韦德 2018年8月12日18:05:23
		 * @param {Object} tabindex
		 */
		function hideOtherWebView(tabindex){
			for (var i = 0 ; i < pages.length ; i ++) {
					if (i != tabindex) {
						plus.webview.hide(pages[i].pageId, "fade-out", 200);
					}
			}
		}
		
		/**
		 * 跳转登录页
		 * @param {Object} $
		 */
		function toLogin($){
			$.openWindow({
				url: 'login.html',
				id: 'login',
				preload: true,
				show: {
					aniShow: 'pop-in',
					duration: 200
				},
				styles: {
					popGesture: 'hide'
				},
				waiting: {
					title: "正在加载...",
					autoShow: true
				}
			});
		}
	</script>
</body>
</html>